<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>如何使用 react-intl - DEVLOG of andyyou</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="DEVLOG of andyyou"><meta name="msapplication-TileImage" content="/img/faicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="DEVLOG of andyyou"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="React 國際化快速概覽：如何建置一個國際化的 React 應用程式。通過本文的協助您可以學會如何偵測使用者的本地資訊，將其儲存在 cookie 並允許使用者變更，提供不同語言的介面，適當的貨幣格式同時也包含一些常見問題的列表。  注意：本文為React Internationalization – How To 的翻譯&amp;#x2F;專案實作更新，大部分文章為翻譯原文，專案與實作則進行簡化與更新。該文由 r"><meta property="og:type" content="article"><meta property="og:title" content="DEVLOG of andyyou"><meta property="og:url" content="https://andyyou.github.io/2019/07/03/react-intl-get-started/"><meta property="og:site_name" content="DEVLOG of andyyou"><meta property="og:description" content="React 國際化快速概覽：如何建置一個國際化的 React 應用程式。通過本文的協助您可以學會如何偵測使用者的本地資訊，將其儲存在 cookie 並允許使用者變更，提供不同語言的介面，適當的貨幣格式同時也包含一些常見問題的列表。  注意：本文為React Internationalization – How To 的翻譯&amp;#x2F;專案實作更新，大部分文章為翻譯原文，專案與實作則進行簡化與更新。該文由 r"><meta property="og:locale" content="zh_TW"><meta property="og:image" content="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/d7cb0aac-f12f-442a-9b64-a9397c2c7dd3/ajax-request-780w-opt.png"><meta property="og:image" content="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/9eb1b1c7-1467-4882-be40-9801c47c3ba6/universal-rendering-is-broken-780w-opt.png"><meta property="article:published_time" content="2019-07-03T08:31:26.000Z"><meta property="article:modified_time" content="2023-05-12T00:48:25.262Z"><meta property="article:author" content="andyyou"><meta property="article:tag" content="react"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/d7cb0aac-f12f-442a-9b64-a9397c2c7dd3/ajax-request-780w-opt.png"><meta property="fb:app_id" content="450470251782295"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://andyyou.github.io/2019/07/03/react-intl-get-started/"},"headline":"如何使用 react-intl","image":["https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/d7cb0aac-f12f-442a-9b64-a9397c2c7dd3/ajax-request-780w-opt.png","https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/9eb1b1c7-1467-4882-be40-9801c47c3ba6/universal-rendering-is-broken-780w-opt.png"],"datePublished":"2019-07-03T08:31:26.000Z","dateModified":"2023-05-12T00:48:25.262Z","author":{"@type":"Person","name":"https://avatars2.githubusercontent.com/u/665690?v=3&s=466"},"publisher":{"@type":"Organization","name":"DEVLOG of andyyou","logo":{"@type":"ImageObject","url":"https://andyyou.github.io/img/logo.png"}},"description":"React 國際化快速概覽：如何建置一個國際化的 React 應用程式。通過本文的協助您可以學會如何偵測使用者的本地資訊，將其儲存在 cookie 並允許使用者變更，提供不同語言的介面，適當的貨幣格式同時也包含一些常見問題的列表。  注意：本文為React Internationalization – How To 的翻譯&#x2F;專案實作更新，大部分文章為翻譯原文，專案與實作則進行簡化與更新。該文由 r"}</script><link rel="canonical" href="https://andyyou.github.io/2019/07/03/react-intl-get-started/"><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-C93NK5NEGP" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-C93NK5NEGP');</script><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><script data-ad-client="ca-pub-3038600205998182" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="DEVLOG of andyyou" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/andyyou"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜尋" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2019-07-03T08:31:26.000Z" title="2019/7/3 下午4:31:26">2019-07-03</time>發表</span><span class="level-item"><time dateTime="2023-05-12T00:48:25.262Z" title="2023/5/12 上午8:48:25">2023-05-12</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Program/">Program</a></span><span class="level-item">35 分鐘讀完 (大約5254個字)</span></div></div><h1 class="title is-3 is-size-4-mobile">如何使用 react-intl</h1><div class="content"><h1 id="React-國際化"><a href="#React-國際化" class="headerlink" title="React 國際化"></a>React 國際化</h1><p>快速概覽：如何建置一個國際化的 React 應用程式。通過本文的協助您可以學會如何偵測使用者的本地資訊，將其儲存在 cookie 並允許使用者變更，提供不同語言的介面，適當的貨幣格式同時也包含一些常見問題的列表。</p>
<blockquote>
<p>注意：本文為<a target="_blank" rel="noopener" href="https://www.smashingmagazine.com/2017/01/internationalizing-react-apps/">React Internationalization – How To</a> 的翻譯/專案實作更新，大部分文章為翻譯原文，專案與實作則進行簡化與更新。該文由 react-intl 官方文件所推薦。<br>進行更新當下 react-intl 版本為 v2.9.0，因此稍微備註 v3+ 的一些警告。</p>
</blockquote>
<span id="more"></span>

<h3 id="術語說明與準備"><a href="#術語說明與準備" class="headerlink" title="術語說明與準備"></a>術語說明與準備</h3><p><em>Internationalization</em> 是一個很長的單字，比較常見的兩個縮寫為 <em>intl</em> 或 <em>i18n</em> 。<em>Localization</em> 則為 <em>l10n</em>。</p>
<p>國際化應用程式一般被分為三個主要的功能：</p>
<ul>
<li>偵測使用者的地區、語系 （locale）</li>
<li>介面上的翻譯</li>
<li>內容格式例如日期，貨幣，數字</li>
</ul>
<p>本文會聚焦在前端的部分，我們會建立一個簡易的 Universal React Application 並支援多地區多語系（locale）。</p>
<p>讓我們使用<a target="_blank" rel="noopener" href="https://github.com/andyyou/simplify-smashing-react-i18n">樣版專案</a>作為我們的起點，這邊我們使用 Express 實作 Server-Side 渲染，webpack 單純使用 Babel 搭配 <code>@babel/preset-env</code> 和 <code>@babel/preset-react</code> 編譯 Client 端的 JavaScript，然後由 Express 取得編譯結果。使用 nodemon 執行開發環境下的 Express，還有 webpack-dev-server 用於提供資源檔。</p>
<blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/andyyou/simplify-smashing-react-i18n">簡化更新版</a> - 除了更新 babel 並移除了 <code>better-npm-run</code> 等套件目標在單純化樣版專案，專注於 react-intl 的學習。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/yury-dymov/smashing-react-i18n">原文專案</a></li>
</ul>
</blockquote>
<p>Server 端的進入點時 <code>server.js</code>。這裡使用了 <code>@babel/polyfill</code> 以支援我們使用一些新的 JavaScript 特性與語法。至於 Server 端的邏輯則位於 <code>src/server.js</code>。在此我們設定了 Express 並監聽 3001 埠。最後，我們渲染一個非常簡單的元件 <code>components/App.js</code>。</p>
<blockquote>
<p>簡化版使用相同目錄結構，但 <code>.jsx</code> 一律變更為 <code>.js</code>。</p>
</blockquote>
<p>Client 端的進入點是 <code>src/client.js</code> ，這裡我們將 <code>components/App.js</code> 掛載至 <code>root</code> 元素上，該 HTML 由 Express 產生。</p>
<blockquote>
<p>簡化版在命名上作了一些調整，但整體邏輯不變。</p>
</blockquote>
<p>在下載完檔案庫的專案之後，執行 <code>npm install</code> 並執行 <code>npm start</code> 即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ git https://github.com/andyyou/simplify-smashing-react-i18n</span><br><span class="line">$ <span class="built_in">cd</span> simplify-smashing-react-i18n</span><br><span class="line">$ npm install</span><br><span class="line"><span class="comment"># (Optional) git reset to start</span></span><br><span class="line">$ git reset d0d971d --hard</span><br><span class="line">$ npm start</span><br></pre></td></tr></table></figure>

<p>然後瀏覽 <code>localhost:3001</code> 可以檢視網站。到此我們完成了基本的準備，可以開始進入主題了。</p>
<h2 id="1-偵測使用者-locale-資訊"><a href="#1-偵測使用者-locale-資訊" class="headerlink" title="1. 偵測使用者 locale 資訊"></a>1. 偵測使用者 locale 資訊</h2><p>有兩種可能的方式可以完成這個需求。基於某些理由，大部分知名的網站包含 Skype 和 NBA 使用 IP 地理位置來判斷使用者的所在地並基於這個訊息去推測使用者使用的語言。然而這個方式不只實作上消耗比較多的資源而且也不是很準確。在人們常旅遊的現代，意味著所在地並不能代表使用者的 locale 。</p>
<blockquote>
<p>locale 通常代表使用者的語系、地區、偏好等資料的集合</p>
</blockquote>
<p>取而代之的是我們會使用第二種方式，通過在伺服器端擷取 HTTP 標頭的 <code>Accept-Language</code> 來取得使用者偏好的語系。現今主流瀏覽器會在每一個請求加上該資訊。</p>
<h3 id="Accept-Language-請求標頭"><a href="#Accept-Language-請求標頭" class="headerlink" title="Accept-Language 請求標頭"></a>Accept-Language 請求標頭</h3><p><code>Accept-Language</code> 請求標頭會提供<strong>回應該請求時</strong>偏好的語系。還可以替每個語系提供權重，這意味著可以建立使用者偏好的語系列表，預設權重（Quality）為 1 <code>q=1</code> 例如：<code>Accept-Language: da, en-gb;q=0.8, en;q=0.7</code> 表示我偏好丹麥語，但我也接受英式英文和其他類型的英文。我們可以去判斷使用者指定的語言範圍是否符合或前綴字符合 （<code>-</code> 之前）。</p>
<p>值得一提的是這種方式仍然不完美。舉例來說，一個使用者可能在網咖或利用公共電腦使用您的網站。因此為了解決這個問題通常需要提供使用者可以方便變更語系的方式。</p>
<h3 id="實作"><a href="#實作" class="headerlink" title="實作"></a>實作</h3><p>這裡的範例使用 Express ，我們使用 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/accept-language">accept-language</a> 套件來協助我們從 HTTP 標頭比對並取得最接近網站支援的語系。如果都找不到則使用預設語系。對於造訪過的用戶則檢查 cookie 來取回之前的設定。</p>
<p>安裝相依套件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i accept-language cookie-parser js-cookie</span><br></pre></td></tr></table></figure>

<p>接著，修改 <code>src/server.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">&#x27;express&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOMServer <span class="keyword">from</span> <span class="string">&#x27;react-dom/server&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> cookieParser <span class="keyword">from</span> <span class="string">&#x27;cookie-parser&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> acceptLanguage <span class="keyword">from</span> <span class="string">&#x27;accept-language&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;./components/App&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> assetUrl = process.env.NODE_ENV !== <span class="string">&#x27;production&#x27;</span> ? <span class="string">&#x27;http://localhost:8050&#x27;</span> : <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> renderHTML = <span class="function"><span class="params">componentHTML</span> =&gt;</span> <span class="string">`</span></span><br><span class="line"><span class="string">  &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">  &lt;html&gt;</span></span><br><span class="line"><span class="string">    &lt;head&gt;</span></span><br><span class="line"><span class="string">        &lt;meta charset=&quot;utf-8&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;Hello React&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;</span></span><br><span class="line"><span class="string">    &lt;body&gt;</span></span><br><span class="line"><span class="string">      &lt;div id=&quot;root&quot;&gt;<span class="subst">$&#123;componentHTML&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;script type=&quot;application/javascript&quot; src=&quot;<span class="subst">$&#123;assetUrl&#125;</span>/public/assets/bundle.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;/body&gt;</span></span><br><span class="line"><span class="string">  &lt;/html&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"><span class="keyword">const</span> detectLocale = <span class="function">(<span class="params">req</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> cookieLocale = req.cookies.locale;</span><br><span class="line">  <span class="keyword">return</span> acceptLanguage.get(cookieLocale || req.headers[<span class="string">&#x27;accept-language&#x27;</span>] || <span class="string">&#x27;en&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">acceptLanguage.languages([<span class="string">&#x27;en&#x27;</span>, <span class="string">&#x27;ru&#x27;</span>]);</span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line">app.use(cookieParser());</span><br><span class="line"></span><br><span class="line">app.use(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> locale = detectLocale(req);</span><br><span class="line">  <span class="keyword">const</span> componentHTML = ReactDOMServer.renderToString(<span class="xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>);</span><br><span class="line"></span><br><span class="line">  res.cookie(<span class="string">&#x27;locale&#x27;</span>, locale, &#123;</span><br><span class="line">    <span class="attr">maxAge</span>: (<span class="keyword">new</span> <span class="built_in">Date</span>() * <span class="number">0.001</span>) + (<span class="number">365</span> * <span class="number">24</span> * <span class="number">3600</span>),</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> res.end(renderHTML(componentHTML));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> PORT = process.env.PORT || <span class="number">3001</span>;</span><br><span class="line"></span><br><span class="line">app.listen(PORT, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Server listening on: <span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>這一步，我們匯入了 <code>accept-language</code> 套件並設定支援英文和俄文 <code>en</code> 和 <code>ru</code> 。然後實作了 <code> detectLocale</code> 函式，首先讀取 cookie 如果沒有則接著查 <code>Accept-Language</code> 標頭，最後如果都沒有則設定 <code>en</code> 為預設。在處理完請求之後加入 <code>Set-Cookie</code> 用於後續的請求。</p>
<h2 id="2-介面翻譯"><a href="#2-介面翻譯" class="headerlink" title="2. 介面翻譯"></a>2. 介面翻譯</h2><p>本文使用 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/react-intl">react-intl</a> 來完成我們的需求。這是 React 生態中目前比較流行並經過實戰檢驗的 i18n 套件。它和多數的 React 套件使用相同的方式： 提供 <em>High order components</em> 高階元件加上 React Context 的功能注入多國語系的函式來處理訊息、時間、數字、貨幣格式。</p>
<p>第一步需要設定 Provider，為了完成這步我們將要安裝套件與變更 <code>src/server.js</code> 和 <code>src/client.js</code> 檔案。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i react-intl</span><br></pre></td></tr></table></figure>

<p>下面是 <code>src/server.js</code> 主要是加入 <code>react-intl</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">&#x27;express&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOMServer <span class="keyword">from</span> <span class="string">&#x27;react-dom/server&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> cookieParser <span class="keyword">from</span> <span class="string">&#x27;cookie-parser&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> acceptLanguage <span class="keyword">from</span> <span class="string">&#x27;accept-language&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; IntlProvider &#125; <span class="keyword">from</span> <span class="string">&#x27;react-intl&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;./components/App&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> assetUrl = process.env.NODE_ENV !== <span class="string">&#x27;production&#x27;</span> ? <span class="string">&#x27;http://localhost:8050&#x27;</span> : <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> renderHTML = <span class="function"><span class="params">componentHTML</span> =&gt;</span> <span class="string">`</span></span><br><span class="line"><span class="string">  &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">  &lt;html&gt;</span></span><br><span class="line"><span class="string">    &lt;head&gt;</span></span><br><span class="line"><span class="string">        &lt;meta charset=&quot;utf-8&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;Hello React&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;</span></span><br><span class="line"><span class="string">    &lt;body&gt;</span></span><br><span class="line"><span class="string">      &lt;div id=&quot;root&quot;&gt;<span class="subst">$&#123;componentHTML&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;script type=&quot;application/javascript&quot; src=&quot;<span class="subst">$&#123;assetUrl&#125;</span>/public/assets/bundle.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;/body&gt;</span></span><br><span class="line"><span class="string">  &lt;/html&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"><span class="keyword">const</span> detectLocale = <span class="function">(<span class="params">req</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> cookieLocale = req.cookies.locale;</span><br><span class="line">  <span class="keyword">return</span> acceptLanguage.get(cookieLocale || req.headers[<span class="string">&#x27;accept-language&#x27;</span>] || <span class="string">&#x27;en&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">acceptLanguage.languages([<span class="string">&#x27;en&#x27;</span>, <span class="string">&#x27;ru&#x27;</span>]);</span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line">app.use(cookieParser());</span><br><span class="line">app.use(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> locale = detectLocale(req);</span><br><span class="line">  <span class="keyword">const</span> componentHTML = ReactDOMServer.renderToString(</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">IntlProvider</span> <span class="attr">locale</span>=<span class="string">&#123;locale&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">IntlProvider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  res.cookie(<span class="string">&#x27;locale&#x27;</span>, locale, &#123;</span><br><span class="line">    <span class="attr">maxAge</span>: (<span class="keyword">new</span> <span class="built_in">Date</span>() * <span class="number">0.001</span>) + (<span class="number">365</span> * <span class="number">24</span> * <span class="number">3600</span>),</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> res.end(renderHTML(componentHTML));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> PORT = process.env.PORT || <span class="number">3001</span>;</span><br><span class="line">app.listen(PORT, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Server listening on: <span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>接著是 <code>src/client.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; IntlProvider &#125; <span class="keyword">from</span> <span class="string">&#x27;react-intl&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> Cookie <span class="keyword">from</span> <span class="string">&#x27;js-cookie&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;./components/App&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> locale = Cookie.get(<span class="string">&#x27;locale&#x27;</span>) || <span class="string">&#x27;en&#x27;</span>;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">IntlProvider</span> <span class="attr">locale</span>=<span class="string">&#123;locale&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">IntlProvider</span>&gt;</span></span>,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>現在，<code>IntlProvider</code> 的子元件都可以存取多語系國際化功能的函式。讓我們加入一些翻譯文字到程式中搭配一個按鈕可以變更 locale。這裡我們有兩個方式：不管是 <code>FormattedMessage</code> 元件或者 <code>formatMessage</code> 函式都可以協助我們轉換語系。差別是元件內容會被 <code>span</code> 包起來，這個在作為標籤的內容是沒問題的，但是針對 HTML 屬性例如 <code>alt</code> <code>title</code> 則需要函式。</p>
<p>先讓我們在 <code>src/components/App.js</code> 加入一些範例看看：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; FormattedMessage &#125; <span class="keyword">from</span> <span class="string">&#x27;react-intl&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> App =  <span class="function">() =&gt;</span> (</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">FormattedMessage</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">id</span>=<span class="string">&quot;app.hello_world&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">defaultMessage</span>=<span class="string">&quot;Hello World!&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">description</span>=<span class="string">&quot;Hello world header greeting&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">    /&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App;</span><br></pre></td></tr></table></figure>

<p>注意到 <code>id</code> 在整個應用程式中必須要是唯一值，因此很合理的是我們可以建立一些命名規則例如： <code>componentName.uniqueIdInComponent</code>。接著，<code>defaultMessage</code> 會使用在預設語系，<code>description</code> 則是用來給那些翻譯者一些資訊。</p>
<p>重新執行 <code>npm start</code> 並重新載入頁面，您一樣可以看到 Hello World 的訊息，不過如果您開啟開發者工具檢視會看到現在文字被 <code>span</code> 包起來了。這種情況下多一個 <code>span</code> 不是什麼太大的問題，不過有時候我們只想要文字本身不要任何標籤。要完成這個需求我們需要直接存取 <code>react-intl</code> 提供的物件。</p>
<p>讓我們回到 <code>src/components/App.js</code>：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; FormattedMessage, intlShape, injectIntl, defineMessages &#125; <span class="keyword">from</span> <span class="string">&#x27;react-intl&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> messages = defineMessages(&#123;</span><br><span class="line">  <span class="attr">helloWorld2</span>: &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="string">&#x27;app.hello_world2&#x27;</span>,</span><br><span class="line">    <span class="attr">defaultMessage</span>: <span class="string">&#x27;Hello World 2!&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> App =  <span class="function">(<span class="params">props</span>) =&gt;</span> (</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">FormattedMessage</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">id</span>=<span class="string">&quot;app.hello_world&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">defaultMessage</span>=<span class="string">&quot;Hello World!&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">description</span>=<span class="string">&quot;Hello world header greeting&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">    /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;props.intl.formatMessage(messages.helloWorld2)&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">App.propTypes = &#123;</span><br><span class="line">  <span class="attr">intl</span>: intlShape.isRequired,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> injectIntl(App);</span><br></pre></td></tr></table></figure>

<p>上面我們增加了不少程式碼。首先，我們必須要使用 <code>injectIntl</code> 將我們的元件包起來，其作用是傳入 <code>intl</code> 物件。為了取得翻譯後的訊息，我們必須要使用 <code>formatMessage</code> 方法和傳入 <code>message</code> 物件。一個 <code>message</code> 物件必須要有一個全域唯一的 <code>id</code> 和 <code>defaultValue</code> 屬性。使用 <code>react-intl</code> 提供的 <code>defineMessages</code> 來定義該物件。</p>
<p>關於 <code>react-intl</code> 最棒的事情就是其生態系。接著，我們可以加入 <code>babel-plugin-react-intl</code>。</p>
<blockquote>
<p>注意如果您參考的是原文的檔案庫，請使用 <code>babel-plugin-react-intl@2.4.0</code> 版本。</p>
</blockquote>
<p>該 babel 擴充套件會從我們的元件中讀取 <code>FormattedMessages</code> 並建立字典檔。然後我們可以把這份字典檔交給翻譯人員。</p>
<blockquote>
<p>事實上您可以單純傳入 <code>formatMessage</code> 一個具備相同屬性的物件即可。使用 <code>defineMessages</code> 的原因是它會加入 <code>babel-plugin-react-intl</code> 的 Hook 協助該套件擷取字典檔。</p>
</blockquote>
<p>安裝該套件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i babel-plugin-react-intl -D</span><br></pre></td></tr></table></figure>

<p>之後 <code>.babelrc</code> 加入設定</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;presets&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;@babel/preset-env&quot;</span>,</span><br><span class="line">    <span class="string">&quot;@babel/preset-react&quot;</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;env&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;development&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;plugins&quot;</span>: [</span><br><span class="line">        [<span class="string">&quot;react-intl&quot;</span>, &#123;</span><br><span class="line">          <span class="attr">&quot;messagesDir&quot;</span>: <span class="string">&quot;build/messages/&quot;</span></span><br><span class="line">        &#125;]</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：<code>package.json</code> 需加入環境變數 <code>NODE_ENV=development</code>。</p>
</blockquote>
<p>重啓 Express <code>npm start</code> 或者 <code>npm run express</code> 即可看到 <code>build/messages</code> 目錄被建立在專案根目錄下。內部的檔案結構則是對照原始專案。我們需要合併所有檔案變成單一 JSON 檔案。可以參考<a target="_blank" rel="noopener" href="https://github.com/yury-dymov/smashing-react-i18n/blob/solution/scripts/translate.js">scripts</a>。儲存在 <code>scripts/translate.js</code> 。然後在 <code>package.json</code> 加入新的 script 指令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i @babel/cli -D</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="attr">&quot;build:langs&quot;</span>: <span class="string">&quot;babel scripts/translate.js | node&quot;</span>,</span><br><span class="line">  ...</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p> 接著，試試指令</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm run build:langs</span><br></pre></td></tr></table></figure>

<p>您應該會看到 <code>build/lang/en.json</code> 被建立了。其內容為：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;app.hello_world&quot;</span>: <span class="string">&quot;Hello World!&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;app.hello_world2&quot;</span>: <span class="string">&quot;Hello World 2!&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>現在最有趣的部分來了。在 Server 端，我們可以載入所有的翻譯到記憶體，然後根據請求提供對應的語系。然而在 Client 端這個方法並不適用，Client 端只能依據需求一次取得所需的 JSON 檔案，然後自動套用提供給所有元件。</p>
<p>讓我們複製編譯的輸出結果到 <code>public/assets</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cp build/lang/en.json public/assets/en.json</span><br></pre></td></tr></table></figure>

<p>接著，建立一份 <code>public/assets/ru.json</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;app.hello_world&quot;</span>: <span class="string">&quot;Привет мир!&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;app.hello_world2&quot;</span>: <span class="string">&quot;Привет мир 2!&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>處理好字典檔之後我們開始調整 Server 和 Client 端的程式碼。</p>
<p>首先是 <code>src/server.js</code> ，因為修改的地方比較多，下面先把重點點出，再列出完整程式碼方便對照：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 匯入相依的函式 addLocaleData、fs、path 等</span></span><br><span class="line"><span class="keyword">import</span> &#123; addLocaleData, IntlProvider &#125; <span class="keyword">from</span> <span class="string">&#x27;react-intl&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> en <span class="keyword">from</span> <span class="string">&#x27;react-intl/locale-data/en&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> ru <span class="keyword">from</span> <span class="string">&#x27;react-intl/locale-data/ru&#x27;</span>;</span><br><span class="line"></span><br><span class="line">addLocaleData([…ru, …en]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 宣告 messages 和 localeData</span></span><br><span class="line"><span class="comment">// 一個是字典檔，一個是 react-intl 提供給日期、數字等的格式資源</span></span><br><span class="line"><span class="keyword">const</span> messages = &#123;&#125;;</span><br><span class="line"><span class="keyword">const</span> localeData = &#123;&#125;;</span><br><span class="line">[<span class="string">&#x27;en&#x27;</span>, <span class="string">&#x27;ru&#x27;</span>].forEach(<span class="function">(<span class="params">locale</span>) =&gt;</span> &#123;</span><br><span class="line">  localeData[locale] = fs.readFileSync(path.join(__dirname, <span class="string">&#x27;../node_modules/react-intl/locale-data/$&#123;locale&#125;.js&#x27;</span>)).toString();</span><br><span class="line">  messages[locale] = <span class="built_in">require</span>(<span class="string">&#x27;../public/assets/$&#123;locale&#125;.json&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 將 localeData 加入 HTML</span></span><br><span class="line"><span class="keyword">const</span> renderHTML = <span class="function">(<span class="params">componentHTML, locale</span>) =&gt;</span> <span class="string">`</span></span><br><span class="line"><span class="string">  &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">  &lt;html&gt;</span></span><br><span class="line"><span class="string">    &lt;head&gt;</span></span><br><span class="line"><span class="string">        &lt;meta charset=&quot;utf-8&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;Hello React&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;</span></span><br><span class="line"><span class="string">    &lt;body&gt;</span></span><br><span class="line"><span class="string">      &lt;div id=&quot;root&quot;&gt;<span class="subst">$&#123;componentHTML&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;script type=&quot;application/javascript&quot; src=&quot;<span class="subst">$&#123;assetUrl&#125;</span>/public/assets/bundle.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">      &lt;script type=&quot;application/javascript&quot;&gt;</span></span><br><span class="line"><span class="string">        <span class="subst">$&#123;localeData[locale]&#125;</span></span></span><br><span class="line"><span class="string">      &lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;/body&gt;</span></span><br><span class="line"><span class="string">  &lt;/html&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在 Provider 加入 messages 參數</span></span><br><span class="line"><span class="keyword">const</span> componentHTML = ReactDOMServer.renderToString(</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">IntlProvider</span> <span class="attr">locale</span>=<span class="string">&#123;locale&#125;</span> <span class="attr">messages</span>=<span class="string">&#123;messages[locale]&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">IntlProvider</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// renderHTML 加入 locale 參數</span></span><br><span class="line"><span class="keyword">return</span> res.end(renderHTML(componentHTML, locale));</span><br></pre></td></tr></table></figure>

<p>完整 <code>src/server.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">&#x27;express&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOMServer <span class="keyword">from</span> <span class="string">&#x27;react-dom/server&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> cookieParser <span class="keyword">from</span> <span class="string">&#x27;cookie-parser&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> acceptLanguage <span class="keyword">from</span> <span class="string">&#x27;accept-language&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; IntlProvider, addLocaleData &#125; <span class="keyword">from</span> <span class="string">&#x27;react-intl&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;./components/App&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> en <span class="keyword">from</span> <span class="string">&#x27;react-intl/locale-data/en&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> ru <span class="keyword">from</span> <span class="string">&#x27;react-intl/locale-data/ru&#x27;</span>;</span><br><span class="line"></span><br><span class="line">addLocaleData([...ru, ...en]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> messages = &#123;&#125;;</span><br><span class="line"><span class="keyword">const</span> localeData = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">[<span class="string">&#x27;en&#x27;</span>, <span class="string">&#x27;ru&#x27;</span>].forEach(<span class="function">(<span class="params">locale</span>) =&gt;</span> &#123;</span><br><span class="line">  localeData[locale] = fs.readFileSync(path.join(__dirname, <span class="string">`../node_modules/react-intl/locale-data/<span class="subst">$&#123;locale&#125;</span>.js`</span>)).toString();</span><br><span class="line">  messages[locale] = <span class="built_in">require</span>(<span class="string">`../public/assets/<span class="subst">$&#123;locale&#125;</span>.json`</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> assetUrl = process.env.NODE_ENV !== <span class="string">&#x27;production&#x27;</span> ? <span class="string">&#x27;http://localhost:8050&#x27;</span> : <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> renderHTML = <span class="function">(<span class="params">componentHTML, locale</span>) =&gt;</span> <span class="string">`</span></span><br><span class="line"><span class="string">  &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">  &lt;html&gt;</span></span><br><span class="line"><span class="string">    &lt;head&gt;</span></span><br><span class="line"><span class="string">        &lt;meta charset=&quot;utf-8&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;Hello React&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;</span></span><br><span class="line"><span class="string">    &lt;body&gt;</span></span><br><span class="line"><span class="string">      &lt;div id=&quot;root&quot;&gt;<span class="subst">$&#123;componentHTML&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;script type=&quot;application/javascript&quot; src=&quot;<span class="subst">$&#123;assetUrl&#125;</span>/public/assets/bundle.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">      &lt;script type=&quot;application/javascript&quot;&gt;</span></span><br><span class="line"><span class="string">        <span class="subst">$&#123;localeData[locale]&#125;</span></span></span><br><span class="line"><span class="string">      &lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;/body&gt;</span></span><br><span class="line"><span class="string">  &lt;/html&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"><span class="keyword">const</span> detectLocale = <span class="function">(<span class="params">req</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> cookieLocale = req.cookies.locale;</span><br><span class="line">  <span class="keyword">return</span> acceptLanguage.get(cookieLocale || req.headers[<span class="string">&#x27;accept-language&#x27;</span>] || <span class="string">&#x27;en&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">acceptLanguage.languages([<span class="string">&#x27;en&#x27;</span>, <span class="string">&#x27;ru&#x27;</span>]);</span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line">app.use(cookieParser());</span><br><span class="line">app.use(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> locale = detectLocale(req);</span><br><span class="line">  <span class="keyword">const</span> componentHTML = ReactDOMServer.renderToString(</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">IntlProvider</span> <span class="attr">locale</span>=<span class="string">&#123;locale&#125;</span> <span class="attr">messages</span>=<span class="string">&#123;messages[locale]&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">IntlProvider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  res.cookie(<span class="string">&#x27;locale&#x27;</span>, locale, &#123;</span><br><span class="line">    <span class="attr">maxAge</span>: (<span class="keyword">new</span> <span class="built_in">Date</span>() * <span class="number">0.001</span>) + (<span class="number">365</span> * <span class="number">24</span> * <span class="number">3600</span>),</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> res.end(renderHTML(componentHTML, locale));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> PORT = process.env.PORT || <span class="number">3001</span>;</span><br><span class="line">app.listen(PORT, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Server listening on: <span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>這裡我們完成了下列幾件事：</p>
<ul>
<li>快取字典檔（messages）以及針對特定語系（locale-data）、環境為 JavaScript 提供 <code>DateTime</code>，<code>Number</code> 格式</li>
<li>調整 <code>renderHTML</code> 方法，因此我們可以插入特定語系的 <code>locale-data</code></li>
<li>提供字典檔資源給 <code>IntlProvider</code></li>
</ul>
<p>對於 Client 端 <code>src/client.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; IntlProvider, addLocaleData &#125; <span class="keyword">from</span> <span class="string">&#x27;react-intl&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> Cookie <span class="keyword">from</span> <span class="string">&#x27;js-cookie&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;./components/App&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> locale = Cookie.get(<span class="string">&#x27;locale&#x27;</span>) || <span class="string">&#x27;en&#x27;</span>;</span><br><span class="line"></span><br><span class="line">fetch(<span class="string">`/public/assets/<span class="subst">$&#123;locale&#125;</span>.json`</span>)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (res.status &gt;= <span class="number">400</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;Bad response from server&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res.json();</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">localeMessages</span>) =&gt;</span> &#123;</span><br><span class="line">    addLocaleData(<span class="built_in">window</span>.ReactIntlLocaleData[locale]);</span><br><span class="line">    ReactDOM.render(</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">IntlProvider</span> <span class="attr">locale</span>=<span class="string">&#123;locale&#125;</span> <span class="attr">messages</span>=<span class="string">&#123;localeMessages&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">IntlProvider</span>&gt;</span></span>,</span><br><span class="line">      <span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>),</span><br><span class="line">    );</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p>接著我們需要調整 <code>src/server.js</code> 讓 Express 提供字典檔 JSON</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.use(cookieParser());</span><br><span class="line">app.use(<span class="string">&#x27;/public/assets&#x27;</span>, express.static(<span class="string">&#x27;public/assets&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>在 JavaScript 初始化之後，<code>client.js</code>會從 cookie 取得 locale 並請求 JSON 字典檔。執行完此步驟之後， SPA 應用程式應該要跟之前一樣運作。</p>
<p>是時候來檢查一下是否運作正常了。開啟開發者工具並切換至 <em>Network</em> 頁籤查看 JSON 是否有被成功下載。</p>
<p><img src="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/d7cb0aac-f12f-442a-9b64-a9397c2c7dd3/ajax-request-780w-opt.png"></p>
<p>為了完成這個段落的功能。讓我們加入 <code>src/components/LocaleButton.js</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安裝套件</span></span><br><span class="line">$ npm i prop-types</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> PropTypes <span class="keyword">from</span> <span class="string">&#x27;prop-types&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> Cookie <span class="keyword">from</span> <span class="string">&#x27;js-cookie&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LocaleButton = <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> handleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    Cookie.set(<span class="string">&#x27;locale&#x27;</span>, props.locale === <span class="string">&#x27;en&#x27;</span> ? <span class="string">&#x27;ru&#x27;</span> : <span class="string">&#x27;en&#x27;</span>);</span><br><span class="line">    <span class="built_in">window</span>.location.reload();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;props.locale === &#x27;en&#x27; ? &#x27;Russian&#x27; : &#x27;English&#x27;&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line">LocaleButton.propTypes = &#123;</span><br><span class="line">  <span class="attr">locale</span>: PropTypes.string.isRequired,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> LocaleButton;</span><br></pre></td></tr></table></figure>

<p>接著，在 <code>src/components/App.js</code> 中匯入使用</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; FormattedMessage, intlShape, injectIntl, defineMessages &#125; <span class="keyword">from</span> <span class="string">&#x27;react-intl&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> LocaleButton <span class="keyword">from</span> <span class="string">&#x27;./LocaleButton&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> messages = defineMessages(&#123;</span><br><span class="line">  <span class="attr">helloWorld2</span>: &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="string">&#x27;app.hello_world2&#x27;</span>,</span><br><span class="line">    <span class="attr">defaultMessage</span>: <span class="string">&#x27;Hello World 2!&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> App =  <span class="function">(<span class="params">props</span>) =&gt;</span> (</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">FormattedMessage</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">id</span>=<span class="string">&quot;app.hello_world&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">defaultMessage</span>=<span class="string">&quot;Hello World!&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">description</span>=<span class="string">&quot;Hello world header greeting&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">    /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;props.intl.formatMessage(messages.helloWorld2)&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">LocaleButton</span> <span class="attr">locale</span>=<span class="string">&#123;props.intl.locale&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">App.propTypes = &#123;</span><br><span class="line">  <span class="attr">intl</span>: intlShape.isRequired,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> injectIntl(App);</span><br></pre></td></tr></table></figure>

<p>一旦使用者變更 <code>locale</code> 我們將會重載頁面確保對應的 JSON 和翻譯被下載。</p>
<p>現在我們已經學會如何偵測用戶的本地資訊和切換語系。在繼續之前讓我們先來討論兩個重要的議題。</p>
<h3 id="複數和樣版"><a href="#複數和樣版" class="headerlink" title="複數和樣版"></a>複數和樣版</h3><p>在英文大部分的單字有單數和複數的形式 <em>One apple</em> 和 <em>Many apples</em> 。其他語言甚至更複雜例如俄語有 4 種形式。我們希望 <code>react-intl</code> 能夠協助我們處理這個問題。因此它也支援樣版讓我們可以提供多個變數插入樣版之中。下面我們來看看這是如何完成的。</p>
<p>在 <code>src/components/App.js</code> 我們可以如下：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> messages = defineMessages(&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="attr">counting</span>: &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="string">&#x27;app.counting&#x27;</span>,</span><br><span class="line">    <span class="attr">defaultMessage</span>: <span class="string">&#x27;I need to buy &#123;count, number&#125; &#123;count, plural, one &#123;apple&#125; other &#123;apples&#125;&#125;&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;props.intl.formatMessage(messages.counting, &#123; count: 1 &#125;)&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;props.intl.formatMessage(messages.counting, &#123; count: 2 &#125;)&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;props.intl.formatMessage(messages.counting, &#123; count: 5 &#125;)&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>上面我們定義了一個樣版搭配 <code>count</code> 變數。當 <code>count</code> 為 1 時顯示 <em>1 apple</em> 其他例如 2 則為 <em>2 apples</em>。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/formatjs/react-intl/blob/master/docs/API.md#formatmessage">formatMessage(descriptor, values)</a> 有兩個參數，這時我們必須要將變數傳入 <code>formatMessage</code> 的第二個參數。</p>
<p>接著重新編譯我們的字典檔並加入俄語的翻譯來檢查我們可以正確的支援英文和俄語。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm run build:langs</span><br></pre></td></tr></table></figure>



<blockquote>
<p>重點整理</p>
<ul>
<li>本範例開發環境下，只要有使用 <code>FormattedMessage</code> 元件或 <code>defineMessages</code> 方法 <code>babel-babel-plugin-react-intl</code> 就會把需要翻譯的字串擷取到 <code>build/messages</code></li>
<li>然後我們使用 <code>npm run build:langs</code> 去建立字典檔，不過這只會包含預設語系的而已</li>
<li>將字典檔複製到 <code>public/assets</code> 並翻譯至其他語系</li>
</ul>
</blockquote>
<p>下面是俄語的翻譯：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;app.hello_world2&quot;</span>: <span class="string">&quot;Привет мир 2!&quot;</span>,</span><br><span class="line">  <span class="string">&quot;app.counting&quot;</span>: <span class="string">&quot;Мне нужно купить &#123;count, number&#125; &#123;count, plural, one &#123;яблоко&#125; few &#123;яблока&#125; many &#123;яблок&#125;&#125;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;app.hello_world&quot;</span>: <span class="string">&quot;Привет мир!&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>到此所有情境我們都處理了。可以繼續下一個階段了。</p>
<h2 id="3-提供特定地區習慣的內容格式，例如日期、貨幣與數字"><a href="#3-提供特定地區習慣的內容格式，例如日期、貨幣與數字" class="headerlink" title="3. 提供特定地區習慣的內容格式，例如日期、貨幣與數字"></a>3. 提供特定地區習慣的內容格式，例如日期、貨幣與數字</h2><p>資料應該要依據不同的地區呈現不同格式。舉例來說俄文顯示 <code>500,00 $</code> 和 <code>10.12.2016</code> 在美國則是 <code>$500.00</code> 和 <code>12/10/2016</code>。</p>
<p><code>react-intl</code> 提供處理元件處理像是日期，還有相對時間（自己會自動每10秒更新一次）</p>
<p>我們在 <code>src/components/App.js</code> 加入此功能：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  FormattedDate,</span><br><span class="line">  FormattedRelative,</span><br><span class="line">  FormattedNumber,</span><br><span class="line">  FormattedMessage,</span><br><span class="line">  intlShape,</span><br><span class="line">  injectIntl,</span><br><span class="line">  defineMessages,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;react-intl&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;this.props.intl.formatMessage(messages.counting, &#123; count: 5 &#125;)&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">FormattedDate</span> <span class="attr">value</span>=<span class="string">&#123;Date.now()&#125;</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">FormattedNumber</span> <span class="attr">value</span>=<span class="string">&quot;1000&quot;</span> <span class="attr">currency</span>=<span class="string">&quot;USD&quot;</span> <span class="attr">currencyDisplay</span>=<span class="string">&quot;symbol&quot;</span> <span class="attr">style</span>=<span class="string">&quot;currency&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">FormattedRelative</span> <span class="attr">value</span>=<span class="string">&#123;Date.now()&#125;</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>重新載入頁面您可以注意到 10 秒後 <code>FormattedRelative</code> 會自動更新。您可以在<a target="_blank" rel="noopener" href="https://github.com/formatjs/react-intl/blob/master/docs/Components.md">文件</a>上找到更多元件和範例。</p>
<p>現在，我們可能要面對影響通用渲染的問題：</p>
<p><img src="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/9eb1b1c7-1467-4882-be40-9801c47c3ba6/universal-rendering-is-broken-780w-opt.png"></p>
<p>一般來說當伺服器端回傳 HTML 到客戶端，然後客戶端的 JavaScript 初始化大概會產生 2 秒的誤差。這意味著當我們使用 <code>Date.now()</code> 的時候在 Server 端渲染的資料和 Client 端重新渲染的資料會有誤差。為了解決這個問題 <code>react-intl</code> 提供了特殊的屬性 <code>initialNow</code>。它會提供一個 Server 的時間戳記給 Client 端的 JavaScript 使用。通過這種方式 Server 和 Client 校驗就會一致。在所有元件都掛載完畢之後就會使用瀏覽器當前的時間。</p>
<p>下面是 <code>src/server.js</code> 主要變更的地方：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> renderHTML = <span class="function">(<span class="params">componentHTML, locale, initialNow</span>) =&gt;</span> <span class="string">`</span></span><br><span class="line"><span class="string">  &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">  &lt;html&gt;</span></span><br><span class="line"><span class="string">    &lt;head&gt;</span></span><br><span class="line"><span class="string">        &lt;meta charset=&quot;utf-8&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;Hello React&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;</span></span><br><span class="line"><span class="string">    &lt;body&gt;</span></span><br><span class="line"><span class="string">      &lt;div id=&quot;root&quot;&gt;<span class="subst">$&#123;componentHTML&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;script type=&quot;application/javascript&quot; src=&quot;<span class="subst">$&#123;assetUrl&#125;</span>/public/assets/bundle.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">      &lt;script type=&quot;application/javascript&quot;&gt;</span></span><br><span class="line"><span class="string">        <span class="subst">$&#123;localeData[locale]&#125;</span></span></span><br><span class="line"><span class="string">      &lt;/script&gt;</span></span><br><span class="line"><span class="string">      &lt;script type=&quot;application/javascript&quot;&gt;window.INITIAL_NOW=<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(initialNow)&#125;</span>&lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;/body&gt;</span></span><br><span class="line"><span class="string">  &lt;/html&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.use(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> locale = detectLocale(req);</span><br><span class="line">  <span class="keyword">const</span> initialNow = <span class="built_in">Date</span>.now();</span><br><span class="line">  <span class="keyword">const</span> componentHTML = ReactDOMServer.renderToString(</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">IntlProvider</span> <span class="attr">locale</span>=<span class="string">&#123;locale&#125;</span> <span class="attr">messages</span>=<span class="string">&#123;messages[locale]&#125;</span> <span class="attr">initialNow</span>=<span class="string">&#123;initialNow&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">IntlProvider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  res.cookie(<span class="string">&#x27;locale&#x27;</span>, locale, &#123;</span><br><span class="line">    <span class="attr">maxAge</span>: (<span class="keyword">new</span> <span class="built_in">Date</span>() * <span class="number">0.001</span>) + (<span class="number">365</span> * <span class="number">24</span> * <span class="number">3600</span>),</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> res.end(renderHTML(componentHTML, locale, initialNow));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>然後是 <code>src/client.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;IntlProvider initialNow=&#123;<span class="built_in">parseInt</span>(<span class="built_in">window</span>.INITIAL_NOW, <span class="number">10</span>)&#125; locale=&#123;locale&#125; messages=&#123;localeData&#125;&gt;</span><br></pre></td></tr></table></figure>

<p>重啟 <code>npm start</code> 問題被解決了。</p>
<blockquote>
<p>注意：<code>initialNow</code> 在 3+ 版本中被移除了。</p>
</blockquote>
<h2 id="問題"><a href="#問題" class="headerlink" title="問題"></a>問題</h2><p>因為 <code>react-intl</code> 使用瀏覽器原生的 Intl API 來處理 <code>DateTime</code> 與 <code>Number</code> 格式。雖然這個規範 2012 年就出現了但是還是有主流的瀏覽器並沒有全面支援。甚至像是 Safari 只有在 iOS 10 之後才部分支援。</p>
<p>這意味著如果您要涵蓋所有沒有支援 Intl 的瀏覽器您需要 Polyfill。感謝 <a target="_blank" rel="noopener" href="https://github.com/andyearnshaw/Intl.js">Intl.js</a> ，看起來是完美的解法不過根據經驗它有些缺點。首先是你需要把它加入您的 Bundle 而且它很肥。為了減少下載檔案大小，您可能想只在瀏覽器不支援的情況下才下載 Polyfill 你可以在<a target="_blank" rel="noopener" href="https://github.com/andyearnshaw/Intl.js/">Intl.js 文件</a>找到解法，不過最大的問題是 Intl.js 不是 100% 精準。意思是 Server 端和 Client 端的 <code>DateTime</code> 和 <code>Number</code> 可能有些許誤差。</p>
<p>我曾試圖嘗試其他解決方案。但都有缺點。因此實作了非常簡易的 <a target="_blank" rel="noopener" href="https://github.com/yury-dymov/intl-polyfill">polyfill</a> 它只有局部的功能，無法應用在所有情境，但只有 2 KB 。使用它您甚至不需要實作只針對老舊瀏覽器動態加載，使專案簡單一點，您可以 Fork 並擴展它。</p>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><p>現在您可能覺得事情變得很複雜，您可能想要自己實作所有的東西。我試過一次，我不建議您這麼做。因為最後您只會完成另一個 <code>react-intl</code> 甚至更糟。您可能想說沒有太多選擇讓這個問題處理的更好一些。</p>
<p>也可能想說可以靠 Moment.js 解決 Intl API 的問題。</p>
<p>幸運的是我都試過了所以我可以節省您的時間。我試過 Moment.js 它或許可以解決部分問題但很肥所以我不推薦。</p>
<p>開發自己的 Polyfill 聽起來也不是好點子，因為您勢必需要和許多 Bug 奮鬥。</p>
<p>希望這篇文章可以協助您得到一些所需的知識去建立多語系與國際化的 React 應用程式。</p>
<h2 id="參考"><a href="#參考" class="headerlink" title="參考"></a>參考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.smashingmagazine.com/2017/01/internationalizing-react-apps/">React Internationalization – How To</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/formatjs/react-intl">Github - react-intl
</a></li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>如何使用 react-intl</p><p><a href="https://andyyou.github.io/2019/07/03/react-intl-get-started/">https://andyyou.github.io/2019/07/03/react-intl-get-started/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>andyyou(YOU,ZONGYAN)</p></div></div><div class="level-item is-narrow"><div><h6>發表於</h6><p>2019-07-03</p></div></div><div class="level-item is-narrow"><div><h6>更新於</h6><p>2023-05-12</p></div></div><div class="level-item is-narrow"><div><h6>許可協議</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/react/">react</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜歡這篇文章嗎? 贊助一下作者吧!</h3><div class="buttons is-centered"><a class="button donate" href="https://www.buymeacoffee.com/andyyou" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>送我杯咖啡</span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2019/07/19/s3-cloudfront-media-convert-step-by-step/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">手把手設定 MediaConvert 轉檔 HLS 搭配 S3 + CloudFront</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2019/06/20/gcs-rails-action-text/"><span class="level-item">Rails 6 Action Text 直接上傳圖片至 Google Cloud Storage 失敗</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://avatars2.githubusercontent.com/u/665690?v=3&amp;s=466" alt="andyou"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">andyou</p><p class="is-size-6 is-block">DEVLOG of andyyou</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Taipei</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">221</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分類</p><a href="/categories"><p class="title">8</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">標籤</p><a href="/tags"><p class="title">90</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/andyyou" target="_blank" rel="noopener">追蹤</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/andyyou"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="/"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="/"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="/"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分類</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Cloud/"><span class="level-start"><span class="level-item">Cloud</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/categories/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Fun/"><span class="level-start"><span class="level-item">Fun</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Mobile/"><span class="level-start"><span class="level-item">Mobile</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Program/"><span class="level-start"><span class="level-item">Program</span></span><span class="level-end"><span class="level-item tag">157</span></span></a></li><li><a class="level is-mobile" href="/categories/System/"><span class="level-start"><span class="level-item">System</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/categories/Tools/"><span class="level-start"><span class="level-item">Tools</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/categories/UX/"><span class="level-start"><span class="level-item">UX</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-11-16T01:14:35.000Z">2023-11-16</time></p><p class="title"><a href="/2023/11/16/zero2hero-deploy-laravel-goole-kubernetes-with-ssl/">Zero2Hero：部署 Laravel 10 到 GKE</a></p><p class="categories"><a href="/categories/Cloud/">Cloud</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-18T06:33:32.000Z">2023-10-18</time></p><p class="title"><a href="/2023/10/18/how-optimized-package-imports-in-nextjs/">Next.js 如何優化匯入函式庫</a></p><p class="categories"><a href="/categories/Program/">Program</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-14T03:00:00.000Z">2023-10-14</time></p><p class="title"><a href="/2023/10/14/nextjs-13-vs-remix/">[譯] Next.js 13 vs Remix 深入解析</a></p><p class="categories"><a href="/categories/Program/">Program</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-14T02:53:58.000Z">2023-10-14</time></p><p class="title"><a href="/2023/10/14/python-env-setup-on-macos/">Python 在 macOS 的環境設定及套件管理指南</a></p><p class="categories"><a href="/categories/Program/">Program</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-09-01T09:08:40.000Z">2023-09-01</time></p><p class="title"><a href="/2023/09/01/async-generator-for-await/">認識 for await</a></p><p class="categories"><a href="/categories/Program/">Program</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">彙整</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/11/"><span class="level-start"><span class="level-item">十一月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/10/"><span class="level-start"><span class="level-item">十月 2023</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/09/"><span class="level-start"><span class="level-item">九月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/06/"><span class="level-start"><span class="level-item">六月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/04/"><span class="level-start"><span class="level-item">四月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">一月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/08/"><span class="level-start"><span class="level-item">八月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">七月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">六月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">五月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">四月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">二月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">一月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">十二月 2021</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">十一月 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">九月 2021</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">八月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">四月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/03/"><span class="level-start"><span class="level-item">三月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">十月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/09/"><span class="level-start"><span class="level-item">九月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/07/"><span class="level-start"><span class="level-item">七月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">五月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/08/"><span class="level-start"><span class="level-item">八月 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/07/"><span class="level-start"><span class="level-item">七月 2019</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/06/"><span class="level-start"><span class="level-item">六月 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/05/"><span class="level-start"><span class="level-item">五月 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/04/"><span class="level-start"><span class="level-item">四月 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/11/"><span class="level-start"><span class="level-item">十一月 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/06/"><span class="level-start"><span class="level-item">六月 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/05/"><span class="level-start"><span class="level-item">五月 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/03/"><span class="level-start"><span class="level-item">三月 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/12/"><span class="level-start"><span class="level-item">十二月 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/11/"><span class="level-start"><span class="level-item">十一月 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/10/"><span class="level-start"><span class="level-item">十月 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/09/"><span class="level-start"><span class="level-item">九月 2017</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/08/"><span class="level-start"><span class="level-item">八月 2017</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/07/"><span class="level-start"><span class="level-item">七月 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/06/"><span class="level-start"><span class="level-item">六月 2017</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/05/"><span class="level-start"><span class="level-item">五月 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/04/"><span class="level-start"><span class="level-item">四月 2017</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/03/"><span class="level-start"><span class="level-item">三月 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/02/"><span class="level-start"><span class="level-item">二月 2017</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/01/"><span class="level-start"><span class="level-item">一月 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/12/"><span class="level-start"><span class="level-item">十二月 2016</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/11/"><span class="level-start"><span class="level-item">十一月 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/10/"><span class="level-start"><span class="level-item">十月 2016</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/09/"><span class="level-start"><span class="level-item">九月 2016</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/08/"><span class="level-start"><span class="level-item">八月 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/06/"><span class="level-start"><span class="level-item">六月 2016</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/05/"><span class="level-start"><span class="level-item">五月 2016</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/04/"><span class="level-start"><span class="level-item">四月 2016</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/03/"><span class="level-start"><span class="level-item">三月 2016</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/02/"><span class="level-start"><span class="level-item">二月 2016</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/01/"><span class="level-start"><span class="level-item">一月 2016</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/12/"><span class="level-start"><span class="level-item">十二月 2015</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/11/"><span class="level-start"><span class="level-item">十一月 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/10/"><span class="level-start"><span class="level-item">十月 2015</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/09/"><span class="level-start"><span class="level-item">九月 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/08/"><span class="level-start"><span class="level-item">八月 2015</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/07/"><span class="level-start"><span class="level-item">七月 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/05/"><span class="level-start"><span class="level-item">五月 2015</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/04/"><span class="level-start"><span class="level-item">四月 2015</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/12/"><span class="level-start"><span class="level-item">十二月 2014</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/11/"><span class="level-start"><span class="level-item">十一月 2014</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/10/"><span class="level-start"><span class="level-item">十月 2014</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/09/"><span class="level-start"><span class="level-item">九月 2014</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/08/"><span class="level-start"><span class="level-item">八月 2014</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/02/"><span class="level-start"><span class="level-item">二月 2014</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/01/"><span class="level-start"><span class="level-item">一月 2014</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2013/11/"><span class="level-start"><span class="level-item">十一月 2013</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2013/10/"><span class="level-start"><span class="level-item">十月 2013</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2013/09/"><span class="level-start"><span class="level-item">九月 2013</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2013/08/"><span class="level-start"><span class="level-item">八月 2013</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2013/03/"><span class="level-start"><span class="level-item">三月 2013</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2012/03/"><span class="level-start"><span class="level-item">三月 2012</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2012/01/"><span class="level-start"><span class="level-item">一月 2012</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2011/11/"><span class="level-start"><span class="level-item">十一月 2011</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">標籤</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/net-mvc/"><span class="tag">.net mvc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RoR/"><span class="tag">RoR</span><span class="tag">15</span></a></div><div class="control"><a class="tags has-addons" href="/tags/api/"><span class="tag">api</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aws/"><span class="tag">aws</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/azure/"><span class="tag">azure</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bot/"><span class="tag">bot</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bundler/"><span class="tag">bundler</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cache/"><span class="tag">cache</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/carrier-wave/"><span class="tag">carrier wave</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/centos/"><span class="tag">centos</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/chrome/"><span class="tag">chrome</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cloudflare/"><span class="tag">cloudflare</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/compass/"><span class="tag">compass</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag">19</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cve/"><span class="tag">cve</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/devise/"><span class="tag">devise</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dnd/"><span class="tag">dnd</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/e-invoice/"><span class="tag">e-invoice</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/entity-framework/"><span class="tag">entity framework</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/envoy/"><span class="tag">envoy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/es6/"><span class="tag">es6</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/facebook/"><span class="tag">facebook</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flux/"><span class="tag">flux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/framework/"><span class="tag">framework</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gcp/"><span class="tag">gcp</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gitlab/"><span class="tag">gitlab</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/go/"><span class="tag">go</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/grunt/"><span class="tag">grunt</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gulp/"><span class="tag">gulp</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/heroku/"><span class="tag">heroku</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/html/"><span class="tag">html</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iisexpress/"><span class="tag">iisexpress</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ios/"><span class="tag">ios</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript/"><span class="tag">javascript</span><span class="tag">88</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript-express-passport/"><span class="tag">javascript express passport</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript-nodejs/"><span class="tag">javascript nodejs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jekyll/"><span class="tag">jekyll</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jetstream/"><span class="tag">jetstream</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jspm/"><span class="tag">jspm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jwt/"><span class="tag">jwt</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/k8s/"><span class="tag">k8s</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/laravel/"><span class="tag">laravel</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/letsencrypt/"><span class="tag">letsencrypt</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mechanism/"><span class="tag">mechanism</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mongodb/"><span class="tag">mongodb</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nextjs/"><span class="tag">nextjs</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nginx/"><span class="tag">nginx</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/node/"><span class="tag">node</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nodejs/"><span class="tag">nodejs</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/oocss/"><span class="tag">oocss</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/osx/"><span class="tag">osx</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/package-manager/"><span class="tag">package manager</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/php/"><span class="tag">php</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/postgres/"><span class="tag">postgres</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/postgresql/"><span class="tag">postgresql</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/queue/"><span class="tag">queue</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rabbitmq/"><span class="tag">rabbitmq</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rack-server/"><span class="tag">rack server</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rails/"><span class="tag">rails</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rails-webpack-stimulus-javascript-bootstrap/"><span class="tag">rails webpack stimulus javascript bootstrap</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/raspberry-pi/"><span class="tag">raspberry-pi</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react/"><span class="tag">react</span><span class="tag">22</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-native/"><span class="tag">react native</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/reactjs/"><span class="tag">reactjs</span><span class="tag">32</span></a></div><div class="control"><a class="tags has-addons" href="/tags/redux/"><span class="tag">redux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ruby/"><span class="tag">ruby</span><span class="tag">18</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sass/"><span class="tag">sass</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/selenium/"><span class="tag">selenium</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/serial-port/"><span class="tag">serial-port</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/slim/"><span class="tag">slim</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ssh/"><span class="tag">ssh</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ssl/"><span class="tag">ssl</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/stimulus/"><span class="tag">stimulus</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/svg-javascript/"><span class="tag">svg javascript</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/task-runner/"><span class="tag">task runner</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tmux/"><span class="tag">tmux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tools/"><span class="tag">tools</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ubuntu/"><span class="tag">ubuntu</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ux/"><span class="tag">ux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vm/"><span class="tag">vm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vue/"><span class="tag">vue</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vuejs/"><span class="tag">vuejs</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/webpack/"><span class="tag">webpack</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/windows/"><span class="tag">windows</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wsl/"><span class="tag">wsl</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xml/"><span class="tag">xml</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/zoom/"><span class="tag">zoom</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">廣告</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3038600205998182" data-ad-slot="6442659171" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="DEVLOG of andyyou" height="28"></a><p class="is-size-7"><span>&copy; 2023 andyyou(YOU,ZONGYAN)</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="GitHub" href="https://github.com/andyyou/"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-TW");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到頁首" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="請輸入關鍵字..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"請輸入關鍵字...","untitled":"(無標題)","posts":"文章","pages":"頁面","categories":"分類","tags":"標籤"});
        });</script></body></html>